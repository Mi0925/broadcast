<div class="gb-monitoring">
	<!-- 消息滚动 -->
	<div class="gb-marquee">
		<marquee behavior="" direction="" align="absmiddle" onmouseover=stop() onmouseout=start()>
			<a href="##">
				<i class="iconfont icon-guangbo i"></i>
				<em class="i">国家应急平台消息国家应急平台消息国家应急平台消息</em>
			</a>
			<a href="##">
				<i class="iconfont icon-guangbo i"></i>
				<em class="i">国家应急平台消息国家应急平台消息国家应急平台消息</em>
			</a>
		</marquee>
	</div>
	<div class="gb-main">
		<!-- 事件按钮组 -->
		<div class="gb-incident-btn">
			<button class="layui-btn layui-btn-normal gb-all-incident">发布效果（全事件）</button>
			<button class="layui-btn layui-btn-primary gb-unity-incident">执行效果（单一事件）</button>
			<button class="layui-btn layui-btn-normal gb-projection-btn">投屏全事件</button>
		</div>
		<!-- 事件总数 -->
		<div class="gb-incident-box">
			<!-- 发布效果（全事件） -->
			<div class="item gb-all-incident-item">
				<div class="gb-chart-box">
					<div class="gb-incident-count">
						<button class="layui-btn layui-btn-danger">事件总数：<em>6</em></button>
						<button class="layui-btn layui-btn-warm">发布总数：<em>6</em></button>
					</div>
					<div class="gb-chart-incident-pie">
						<div class="gb-chart-item">
							<div class="gb-chart gb-pie" id="pie-incident"></div>
						</div>
						<div class="gb-chart-item">
							<div class="gb-chart gb-pie" id="pie-incident-rank"></div>
						</div>
						<div class="gb-chart-item">
							<div class="gb-chart gb-bar" id="bar-task-num"></div>
						</div>
					</div>
					<div class="gb-chart-incident-bar">
						<div class="gb-chart-item">
							<div class="gb-chart gb-bar" id="bar-incident-type"></div>
						</div>
					</div>
				</div>
				<!-- 地图 -->
				<div class="gb-map-box">
					<div id="all-map" class="gb-map"></div>
					<div class="gb-map-zoom">
						<span class="cur j-zoom-province"><em>省</em></span>
						<span class="j-zoom-city"><em>市</em></span>
						<span class="j-zoom-county"><em>县</em></span>
					</div>
				</div>
			</div>
			<!-- 执行效果（单一事件） -->
			<div class="item gb-unity-incident-item" style="display: none;">
				<div class="gb-chart-box">
					 <!-- 杭州西湖区雷暴红色警报消息播发统计 -->
					 <div class="gb-charts-table">
					 	<h4>
						 	<button class="layui-btn layui-btn-danger">杭州西湖区雷暴红色警报消息播发统计</button>
						 	<span><i class="iconfont icon-liebiao"></i>列表</span>
					 	</h4>
					 	<div class="gb-chart-incident-line">
							<div class="gb-chart-item">
								<div class="gb-chart gb-line" id="line-population"></div>
							</div>
							<div class="gb-chart-item">
								<div class="gb-chart gb-line" id="line-district"></div>
							</div>
						</div>
					 </div>
				</div>
				<!-- 地图 -->
				<div class="gb-map-box">
					<div id="unity-map" class="gb-map"></div>
					<div class="gb-map-zoom">
						<span class="cur j-zoom-province"><em>省</em></span>
						<span class="j-zoom-city"><em>市</em></span>
						<span class="j-zoom-county"><em>县</em></span>
					</div>
					<div class="gb-map-legend">
						<span class="j-legend-succeed">
							<i></i>
							<em>已覆盖</em>
						</span>
						<span class="j-legend-process">
							<i></i>
							<em>未完全覆盖</em>
						</span>
						<span class="j-legend-failure">
							<i></i>
							<em>未覆盖</em>
						</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<p class="gb-copyright">© 2017-2018 浙江省应急广播平台</p>
</div>
<script type="text/javascript">
/************************** 执行效果（单一事件） *******************************************/
var boolunity=true;
var boolall=true;
function unityIncident() {
	if(boolunity){
		// 覆盖人口
	    var populationChart = echarts.init(document.getElementById('line-population'));
		populationOption = {
		    title: {
		        text: '时间',
		        textStyle:{
		        	color:'#7c8491',
		        	fontSize:13,
		        },
		        bottom:'4%',
		        left:"1%"
		    },
		    tooltip: {
		        // trigger: 'axis',
		        formatter: function (params, ticket, callback) {
		    		var html='<div class="gb-line-formatter">'+params.seriesName+'<br /><em>'+params.data.percent+'</em>%，<em>'+params.data.value+'</em>万人</div>'
				    // 固定在顶部
				    return html;
				},
		    	position: function (point, params, dom, rect, size) {
				    // 固定在顶部
				    return {left:point[0]-$(dom).width()/2, top:point[1]-$(dom).height()};
				},
		        backgroundColor: 'rgba(255,255,255,0)',
		        axisPointer: {
		            type: 'line',
			        lineStyle: {
			            type: 'dashed',
			            color:'#6e6fe6'
			        },
		        },
		    },
		    grid: {
		    	top:'1%',
		        left: '3%',
		        right: '2%',
		        bottom:"18%",
		        containLabel: true
		    },
		    // 区域缩放
		    dataZoom: [
		        {
		            start: 10,
		            end: 90,
		            backgroundColor:"#d0daeb",
		            fillerColor:"#6e6fe6",
		            handleIcon: handleIcon,
	        		handleSize: '60%',
	        		handleStyle: {
			            color: '#fff',
			        },
					showDataShadow:false,
					height: 22,
		        },
		        {
		            type: 'inside',
		        }
		    ],
		    xAxis: {
		        type: 'category',
		        boundaryGap: false,
		        //坐标轴名称
	        	name: '覆盖人口',
		        nameGap: 30,
		        // nameRotate:0,
		        nameLocation: "center",
		        nameTextStyle:{
		        	color:"#7c8491",
		        },
		        data: ['0', '5:00', '5:20', '5:40', '6:00', '6:20', '6:40', '6:45', '6:50', '6:55', '7:40', '8:40'],
		        splitLine: { //设置X轴的网格
		            show: true,
		            interval: 'auto',
					lineStyle:{
						color: '#f0f0f0'//网格线颜色
					}
		        },
		        //刻度横线
		        axisTick: {
		            show: false
		        },
		        //刻度字样式
		        axisLabel: {
		            textStyle: {
		                color: '#7c8491',
		                fontSize:'12',
		                align: 'center'
		            },
		        },
		        //刻度线
		        axisLine: {
		            lineStyle: {
		                color:"#f0f0f0"//刻度线颜色
		            }
		        },
		    },
		    yAxis: {
		        //坐标轴名称
	        	name: '单位：万人',
		        nameGap: 40,
		        // nameRotate:0,
		        nameLocation: "middle",
		        nameTextStyle:{
		        	color:"#7c8491",
		        },
		        //刻度横线
		        axisTick: {
		            show: false
		        },
		        //刻度字样式
		        axisLabel: {
		            textStyle: {
		                color: '#7c8491',
		                fontSize:'12',
		            }
		        },
		        //刻度线
		        axisLine: {
		            lineStyle: {
		                color:"#f0f0f0"//刻度线颜色
		            }
		        },
		        //网格线
		        splitLine:{
					lineStyle:{
						color: '#f0f0f0'//网格线颜色
					}
				},
		    },
		    series: [{
		    	name:'覆盖人口',
		        type: 'line',
		        symbol:'image://../src/images/icon-line-formatter.png',
		        // showSymbol:false,
		        symbolSize:'15',
		        data: [
		        	{value:120,percent:15},
		        	{value:130,percent:15},
		        	{value:140,percent:15},
		        	{value:150,percent:15},
		        	{value:160,percent:15},
		        	{value:160,percent:15},
		        	{value:160,percent:15},
		        	{value:160,percent:15},
		        	{value:120,percent:15},
		        	{value:180,percent:15},
		        	{value:160,percent:15},
		        	{value:260,percent:15},
		        ],
		        itemStyle:{
		        	normal:{
		        		color:"#7778e8"
		        	}
		        }
		    }]
		};
		populationChart.setOption(populationOption);

		// 覆盖区域
		var districtChart = echarts.init(document.getElementById('line-district'));
		districtOption = {
		    title: {
		        text: '时间',
		        textStyle:{
		        	color:'#7c8491',
		        	fontSize:13,
		        },
		        bottom:'4%',
		        left:"1%"
		    },
		    tooltip: {
		        // trigger: 'axis',
		        formatter: function (params, ticket, callback) {
		    		var html='<div class="gb-line-formatter">'+params.seriesName+'<br /><em>'+params.data.percent+'</em>%，<em>'+params.data.value+'</em>万人</div>'
				    // 固定在顶部
				    return html;
				},
		    	position: function (point, params, dom, rect, size) {
				    // 固定在顶部
				    return {left:point[0]-$(dom).width()/2, top:point[1]-$(dom).height()};
				},
		        backgroundColor: 'rgba(255,255,255,0)',
		        axisPointer: {
		            type: 'line',
			        lineStyle: {
			            type: 'dashed',
			            color:'#6e6fe6'
			        },
		        },
		    },
		    grid: {
		    	top:'1%',
		        left: '3%',
		        right: '2%',
		        bottom:"18%",
		        containLabel: true
		    },
		    // 区域缩放
		    dataZoom: [
		        {
		            start: 10,
		            end: 90,
		            backgroundColor:"#d0daeb",
		            fillerColor:"#3d749a",
		            handleIcon: handleIcon,
	        		handleSize: '60%',
	        		handleStyle: {
			            color: '#fff',
			        },
					showDataShadow:false,
					height: 22,
		        },
		        {
		            type: 'inside',
		        }
		    ],
		    xAxis: {
		        type: 'category',
		        boundaryGap: false,
		        //坐标轴名称
	        	name: '覆盖区域',
		        nameGap: 30,
		        // nameRotate:0,
		        nameLocation: "center",
		        nameTextStyle:{
		        	color:"#7c8491",
		        },
		        data: ['0', '5:00', '5:20', '5:40', '6:00', '6:20', '6:40', '6:45', '6:50', '6:55', '7:40', '8:40'],
		        splitLine: { //设置X轴的网格
		            show: true,
		            interval: 'auto',
					lineStyle:{
						color: '#f0f0f0'//网格线颜色
					}
		        },
		        //刻度横线
		        axisTick: {
		            show: false
		        },
		        //刻度字样式
		        axisLabel: {
		            textStyle: {
		                color: '#7c8491',
		                fontSize:'12',
		                align: 'center'
		            },
		        },
		        //刻度线
		        axisLine: {
		            lineStyle: {
		                color:"#f0f0f0"//刻度线颜色
		            }
		        },
		    },
		    yAxis: {
		        //坐标轴名称
	        	name: '单位：平方公里',
		        nameGap: 40,
		        // nameRotate:0,
		        nameLocation: "middle",
		        nameTextStyle:{
		        	color:"#7c8491",
		        },
		        //刻度横线
		        axisTick: {
		            show: false
		        },
		        //刻度字样式
		        axisLabel: {
		            textStyle: {
		                color: '#7c8491',
		                fontSize:'12',
		            }
		        },
		        //刻度线
		        axisLine: {
		            lineStyle: {
		                color:"#f0f0f0"//刻度线颜色
		            }
		        },
		        //网格线
		        splitLine:{
					lineStyle:{
						color: '#f0f0f0'//网格线颜色
					}
				},
		    },
		    series: [{
		    	name:'覆盖人口',
		        type: 'line',
		        symbol:'image://../src/images/icon-taskNumformatter.png',
		        // showSymbol:false,
		        symbolSize:'15',
		        data: [
		        	{value:120,percent:15},
		        	{value:130,percent:15},
		        	{value:140,percent:15},
		        	{value:150,percent:15},
		        	{value:160,percent:15},
		        	{value:160,percent:15},
		        	{value:160,percent:15},
		        	{value:160,percent:15},
		        	{value:120,percent:15},
		        	{value:180,percent:15},
		        	{value:160,percent:15},
		        	{value:260,percent:15},
		        ],
		        itemStyle:{
		        	normal:{
		        		color:"#3d749a"
		        	}
		        }
		    }]
		};
		districtChart.setOption(districtOption);


		// 地图
		unitybmap = new BMap.Map("unity-map"); // 创建地图实例，禁止点击地图底图
		unitybmap.centerAndZoom(new BMap.Point(120.166085,30.279006), 8);
		unitybmap.enableScrollWheelZoom(true);
	    blist = [];
		districtLoading = 0;
		setTimeout(function () {
		    // 地图划分区域地点
		    addDistrict("杭州",unitybmap,"#ff5b57");
		    addDistrict("宁波",unitybmap,"#ff5b57");
		    addDistrict("嘉兴",unitybmap,"#fada00");
		    addDistrict("绍兴",unitybmap,"#14ae8f");
		    addDistrict("台州",unitybmap,"#14ae8f");
		    addDistrict("温州",unitybmap,"#ff5b57");
		    // #ff5b57代表未覆盖，#14ae8f代表已覆盖，#fada00代表未完全覆盖
		}, 100);
			
	}
	boolunity=false;
}


/************************** 发布效果（全事件） *******************************************/
function addIncident() {
	if(boolall){
	    var incidentChart = echarts.init(document.getElementById('pie-incident'));
	    var incidentRankChart = echarts.init(document.getElementById('pie-incident-rank'));
	    var taskNumChart = echarts.init(document.getElementById('bar-task-num'));
	    var incidentTypeChart = echarts.init(document.getElementById('bar-incident-type'));

	    // 事件发布
		incidentOption = {
		    title: {
		        text: '事件发布',
		        bottom: '0',
		        left:'center',
		        textStyle: { 
		            color: '#585c65'
		        }
		    },
		    tooltip : {
		        formatter: "{b} : {c} ({d}%)"
		    },
		    legend: {
		        // orient: 'vertical',
		        x: 'center',
		        bottom: '10%',
		        itemWidth:'10',
		        itemHeight:'10',
		        data:['气象局','水利','国家应急广播平台','应急办'],
		        align:"right"
		    },
		    series : [
		        {
		            type:'pie',
		            radius : '60%',
		            center: ['50%', '43%'],
		            data:[
			            {
		                	value:25, 
		                	name:'气象局',
		                	itemStyle: {
								normal: {
									color: "#6e6fe6"
								}
					         }
		                },{
		                	value:30, 
		                	name:'水利',
		                	itemStyle: {
								normal: {
									color: "#9ca6ff"
								}
					         }
		                },{
		                	value:15, 
		                	name:'国家应急广播平台',
		                	itemStyle: {
								normal: {
									color: "#1ba5dd"
								}
					         }
		                },{
		                	value:25, 
		                	name:'应急办',
		                	itemStyle: {
								normal: {
									color: "#41cefb"
								}
					         }
		                }
		            ].sort(function (a, b) { return a.value - b.value; }),
		            roseType: 'radius',
		            label: {
		                normal: {
		                    textStyle: {
		                        color: '#7c8491'
		                    }
		                }
		            },
		            labelLine: {
		                normal: {
		                    lineStyle: {
		                        color: '#d8d8d8'
		                    },
		                    smooth: 0.2,
		                    length: 0,
		                    length2: 20
		                }
		            },
		            itemStyle: {
			             normal: {
			                shadowBlur: 15,
			                shadowColor: 'rgba(0, 0, 0, 0.4)',
			                label:{
			                	formatter:'{d}%',
					        },
			             }
			         },

		            animationType: 'scale',
		            animationEasing: 'elasticOut',
		            animationDelay: function (idx) {
		                return Math.random() * 200;
		            }
		        }
		    ]
		};
		incidentChart.setOption(incidentOption);

		// 事件级别发布
		incidentRankOption = {
		    title: {
		        text: '事件级别发布',
		        bottom: '0',
		        left:'center',
		        textStyle: { 
		            color: '#585c65'
		        }
		    },
		    tooltip : {
		        formatter: "{b} : {c} ({d}%)"
		    },
		    legend: {
		        // orient: 'vertical',
		        x: 'center',
		        bottom: '10%',
		        itemWidth:'10',
		        itemHeight:'10',
		        data:['红色事件','橙色事件','黄色事件','蓝色事件','绿色事件'],
		        align:"right"
		    },
		    series : [
		        {
		            type:'pie',
		            radius : '60%',
		            center: ['50%', '43%'],
		            data:[
		                {
		                	value:20, 
		                	name:'红色事件',
		                	itemStyle: {
								normal: {
									color: "#f75c53"
								}
					         },
		                },{
		                	value:25, 
		                	name:'橙色事件',
		                	itemStyle: {
								normal: {
									color: "#fea41e"
								}
					         },
		                },{
		                	value:27, 
		                	name:'黄色事件',
		                	itemStyle: {
								normal: {
									color: "#fada00"
								}
					         },
		                },{
		                	value:30, 
		                	name:'蓝色事件',
		                	itemStyle: {
								normal: {
									color: "#4579d8"
								}
					         },
		                },{
		                	value:33, 
		                	name:'绿色事件',
		                	itemStyle: {
								normal: {
									color: "#14ae8f"
								}
					         },
		                },
		            ].sort(function (a, b) { return a.value - b.value; }),
		            roseType: 'radius',
		            label: {
		                normal: {
		                    textStyle: {
		                        color: '#7c8491'
		                    }
		                }
		            },
		            labelLine: {
		                normal: {
		                    lineStyle: {
		                        color: '#d8d8d8'
		                    },
		                    smooth: 0.2,
		                    length: 10,
		                    length2: 20
		                }
		            },
		            itemStyle: {
			             normal: {
			                shadowBlur: 15,
			                shadowColor: 'rgba(0, 0, 0, 0.4)',
			                label:{
			                	formatter:'{d}%',
					        },
			             }
			         },
			        markLine:{
			        	symbolSize:1000
			        },
		            animationType: 'scale',
		            animationEasing: 'elasticOut',
		            animationDelay: function (idx) {
		                return Math.random() * 200;
		            }
		        }
		    ]
		};
		incidentRankChart.setOption(incidentRankOption);

		// 任务数量
		var taskNumData = [
			{
	    		value:20,
	        	itemStyle: {normal: {color: "#41cefb"}},
	    	},{
	    		value:50,
	        	itemStyle: {normal: {color: "#00aaff"}},
	    	},
	    	{
	    		value:40,
	        	itemStyle: {normal: {color: "#1ba5dd"}},
	    	},
	    	{
	    		value:150,
	        	itemStyle: {normal: {color: "#4579d8"}},
	    	}
	    ];
		var yMax = 180;
		var dataShadow = [];
		for (var i = 0; i < taskNumData.length; i++) {
		    dataShadow.push(yMax);
		}
		taskNumOption = {
		    title: {
		        text: '任务数量',
		        bottom: '0',
		        left:'center',
		        textStyle: { 
		            color: '#585c65'
		        }
		    },
		    tooltip : {
		    	// formatter:"{b}<br />{c}个",
		    	formatter: '<div class="gb-bar-formatter">{b}<br /><em>{c}</em></div>',
		    	position: function (point, params, dom, rect, size) {
				    // 固定在顶部
				    return {left: rect.x-($(dom).width()-rect.width)/1.5, top: rect.y-$(dom).height()-10};
				},
		        backgroundColor: 'rgba(255,255,255,0)',
		        // borderColor:"#d8d8d8",
		        // borderWidth:1,
		        // textStyle:{
		        // 	color:"#000"
		        // },
		    },
		    grid: {
		        left: '8%',
		        containLabel: true
		    },
		    xAxis: {
		        data: ['等待审核', '等待发布', '正在发布', '发布完成'],
		        //刻度横线
		        axisTick: {
		            show: false
		        },
		        //刻度字样式
		        axisLabel: {
		            textStyle: {
		                color: '#7c8491',
		                fontSize:'14',
		                align: 'center'
		            },
		            interval:0,
	         		// margin: 30,
					// rotate:-20,
		        },
		        //刻度线
		        axisLine: {
		            lineStyle: {
		                color:"#e5e5e5"
		            }
		        },
		        z: 10
		    },
		    yAxis: [{
		        //坐标轴名称
	        	name: '单位：个',
		        nameGap: 40,
		        // nameRotate:0,
		        nameLocation: "middle",
		        nameTextStyle:{
		        	color:"#7c8491",
		        },
		        //刻度横线
		        axisTick: {
		            show: false
		        },
		        //刻度字样式
		        axisLabel: {
		            textStyle: {
		                color: '#7c8491',
		                fontSize:'14'
		            }
		        },
		        //刻度线
		        axisLine: {
		            lineStyle: {
		                color:"#e5e5e5"//刻度线颜色
		            }
		        },
		        //网格线
		        splitLine:{
					lineStyle:{
						color: '#e5e5e5'//网格线颜色
					}
				},
		    },{
	            'type': 'value',
	            'max': 200,
		        axisLine: {
		            lineStyle: {
		                color:"#e5e5e5"
		            }
		        }
	        }],
		    dataZoom: [
		        {
		            type: 'inside'
		        }
		    ],
		    series: [
		        { // For shadow
		            type: 'bar',
		            itemStyle: {
		                normal: {color: '#f7f8fa'}
		            },
	        		silent: true,
		            barGap:'-100%',
		            barCategoryGap:'40%',
		            data: dataShadow,
		            animation: false
		        },
		        {
		            type: 'bar',
		            data: taskNumData
		        }
		    ]
		};
		taskNumChart.setOption(taskNumOption);

		// 事件类型统计
		// 事件类型统计数据
		var incidentTypeData = [
			{
	    		value:20,
	        	itemStyle: {normal: {color: "#949eff"}},
	    	},{
	    		value:230,
	        	itemStyle: {normal: {color: "#9b7fe2"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#6b65df"}},
	    	},{
	    		value:20,
	        	itemStyle: {normal: {color: "#949eff"}},
	    	},{
	    		value:45,
	        	itemStyle: {normal: {color: "#9b7fe2"}},
	    	},{
	    		value:70,
	        	itemStyle: {normal: {color: "#6b65df"}},
	    	},{
	    		value:80,
	        	itemStyle: {normal: {color: "#949eff"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#9b7fe2"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#6b65df"}},
	    	},{
	    		value:80,
	        	itemStyle: {normal: {color: "#949eff"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#9b7fe2"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#6b65df"}},
	    	},{
	    		value:80,
	        	itemStyle: {normal: {color: "#949eff"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#9b7fe2"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#6b65df"}},
	    	},{
	    		value:80,
	        	itemStyle: {normal: {color: "#949eff"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#9b7fe2"}},
	    	},{
	    		value:90,
	        	itemStyle: {normal: {color: "#6b65df"}},
	    	}
	    ];
	    // x轴数据
	    var incidentTypexAxis=[
	    	"金属与非金属矿金属与非金属矿1","金属与非金属矿金属与非金属矿2","金属与非金属矿金属与非金属矿3","金属与非金属矿金属与非金属矿4","金属与非金属矿金属与非金属矿5","金属与非金属矿金属与非金属矿6","金属与非金属矿金属与非金属矿7","金属与非金属矿金属与非金属矿8","金属与非金属矿金属与非金属矿9","金属与非金属矿金属与非金属矿10","金属与非金属矿金属与非金属矿11","金属与非金属矿金属与非金属矿12","金属与非金属矿金属与非金属矿13","金属与非金属矿金属与非金属矿14"
	    ];
	    // 对x轴数据换行处理，4个字换行
		var incidentTypexAxisData=[]
	    for (var i = 0; i < incidentTypexAxis.length; i++) {
	    	var strs = incidentTypexAxis[i].split(''); //字符串数组
	        var str = ''
	        for (var j = 0, s; s = strs[j++];) { //遍历字符串数组
	            str += s;
	            if (!(j % 4)) str += '\n';
	        }
	        incidentTypexAxisData.push(str)
	    }
		var yMaxTwo = 300;
		var dataShadowTwo = [];
		for (var i = 0; i < incidentTypeData.length; i++) {
		    dataShadowTwo.push(yMaxTwo);
		}
		incidentTypeOption = {
		    title: {
		        text: '任务数量',
		        bottom: '0',
		        left:'center',
		        textStyle: { 
		            color: '#585c65'
		        }
		    },
		    // 区域缩放
		    dataZoom: [
		        {
		            start: 30,
		            end: 70,
		        	bottom: '8%',
		            backgroundColor:"#d0daeb",
		            fillerColor:"#6e6fe6",
		            handleIcon: handleIcon,
	        		handleSize: '60%',
	        		handleStyle: {
			            color: '#fff',
			        },
					showDataShadow:false,
		        },
		        {
		            type: 'inside',
		        }
		    ],
		    tooltip : {
		    	formatter: '<div class="gb-bar-formatter">{b}<br /><em>{c}</em></div>',
		    	position: function (point, params, dom, rect, size) {
				    // 固定在顶部
				    return {left: rect.x-($(dom).width()/2)+(rect.width/2.2), top: rect.y-$(dom).height()-10};
				},
		        backgroundColor: 'rgba(255,255,255,0)',
		        // borderColor:"#d8d8d8",
		        // borderWidth:1,
		        // textStyle:{
		        // 	color:"#000"
		        // },
		    },
		    grid: {
		        containLabel: true,
		        left:'5%',
		        right:'3%',
		        bottom: '18%',
		    },
		    xAxis: {
		        // data: ['金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿','金属与非\n金属矿金\n属与非金\n属矿'],
		        data:incidentTypexAxisData,
		        //刻度横线
		        axisTick: {
		            show: false
		        },
		        //刻度字样式
		        axisLabel: {
		            textStyle: {
		                color: '#7c8491',
		                fontSize:'14',
		                align: 'center'
		            },
		            // interval:0,//x轴是否自动调整显示数量
		            // formatter:function(val){
		            // 	var strs = val.split(''); //字符串数组
	             //        var str = ''
	             //        for (var i = 0, s; s = strs[i++];) { //遍历字符串数组
	             //            str += s;
	             //            if (!(i % 4)) str += '\n';
	             //        }
	             //        return str
		            // }
	         		// margin: 30,
					// rotate:-20,
		        },
		        //刻度线
		        axisLine: {
		            lineStyle: {
		                color:"#e5e5e5"
		            }
		        },
		        z: 10
		    },
		    yAxis: [{
		        //坐标轴名称
	        	name: '单位：个',
		        nameGap: 40,
		        // nameRotate:0,
		        nameLocation: "middle",
		        nameTextStyle:{
		        	color:"#7c8491",
		        },
		        //刻度横线
		        axisTick: {
		            show: false
		        },
		        //刻度字样式
		        axisLabel: {
		            textStyle: {
		                color: '#7c8491',
		                fontSize:'14'
		            }
		        },
		        //刻度线
		        axisLine: {
		            lineStyle: {
		                color:"#e5e5e5"//刻度线颜色
		            }
		        },
		        //网格线
		        splitLine:{
					lineStyle:{
						color: '#e5e5e5'//网格线颜色
					}
				},
		    },{
	            'type': 'value',
	            'max': 200,
		        axisLine: {
		            lineStyle: {
		                color:"#e5e5e5"
		            }
		        }
	        }],
		    series: [
		        { // For shadow
		            type: 'bar',
		            itemStyle: {
		                normal: {color: '#f7f8fa'}
		            },
	        		silent: true,
		            barGap:'-100%',
		            barCategoryGap:'40%',
		            data: dataShadowTwo,
		            animation: false
		        },
		        {
		            type: 'bar',
		            data: incidentTypeData
		        }
		    ]
		};
		incidentTypeChart.setOption(incidentTypeOption);


		// 地图
		// bmap.clearOverlays();
		var mapChart = echarts.init(document.getElementById('all-map'));
		var geoCoordMap = {
			'杭州': [120.166085,30.279006],
		    '宁波': [121.558386,29.884993],
		    '嘉兴': [120.762703,30.750911],
		    '湖州': [120.105,30.905714],
		    '淳安': [119.022147,29.622863],
		    '临安': [119.723544,30.245816],
		    '余杭': [120.301046,30.4266],
			'上海': [121.4648, 31.2891],
		};//地点坐标
		var BJData = [
			[{
		        name: '杭州'//出发点
		    }, {
		        name: '宁波',//到达点
		        incident:'red',//事件颜色
		        incident_data:[
		        	{color:"red",incident_name:"宁波雷暴事件"},
		        	{color:"orange",incident_name:"宁波雾霾事件"},
		        	{color:"yellow",incident_name:"宁波暴雨事件"},
		        	{color:"blue",incident_name:"宁波台风事件"},
		        	{color:"green",incident_name:"宁波龙卷风事件"},
		        ]//具体事件
		    }],
		    [{
		        name: '杭州'
		    }, {
		        name: '嘉兴',
		        incident:'orange',
		        incident_data:[
		        	{color:"red",incident_name:"雷暴事件"},
		        	{color:"orange",incident_name:"雾霾事件"},
		        	{color:"yellow",incident_name:"暴雨事件"},
		        	{color:"blue",incident_name:"台风事件"},
		        	{color:"green",incident_name:"龙卷风事件"},
		        ]
		    }],
		    [{
		        name: '杭州'
		    }, {
		        name: '湖州',
		        incident:'yellow',
		        incident_data:[
		        	{color:"red",incident_name:"雷暴事件"},
		        	{color:"orange",incident_name:"雾霾事件"},
		        	{color:"yellow",incident_name:"暴雨事件"},
		        	{color:"blue",incident_name:"台风事件"},
		        	{color:"green",incident_name:"龙卷风事件"},
		        ]
		    }],
		    [{
		        name: '杭州'
		    }, {
		        name: '淳安',
		        incident:'blue',
		        incident_data:[
		        	{color:"red",incident_name:"雷暴事件"},
		        	{color:"orange",incident_name:"雾霾事件"},
		        	{color:"yellow",incident_name:"暴雨事件"},
		        	{color:"blue",incident_name:"台风事件"},
		        	{color:"green",incident_name:"龙卷风事件"},
		        ]
		    }],
		    [{
		        name: ''
		    }, {
		        name: '余杭',
		        incident:'green',
		        incident_data:[
		        	{color:"red",incident_name:"雷暴事件"},
		        	{color:"orange",incident_name:"雾霾事件"},
		        	{color:"yellow",incident_name:"暴雨事件"},
		        	{color:"blue",incident_name:"台风事件"},
		        	{color:"green",incident_name:"龙卷风事件"},
		        ]
		    }],
		    [{
		        name: ''
		    }, {
		        name: '临安',
		        incident:'green',
		        incident_data:[
		        	{color:"red",incident_name:"雷暴事件"},
		        	{color:"orange",incident_name:"雾霾事件"},
		        	{color:"yellow",incident_name:"暴雨事件"},
		        	{color:"blue",incident_name:"台风事件"},
		        	{color:"green",incident_name:"龙卷风事件"},
		        ]
		    }],
		    [{
		        name: ''
		    }, {
		        name: '上海',
		        incident:'orange',
		        incident_data:[
		        	{color:"red",incident_name:"雷暴事件"},
		        	{color:"orange",incident_name:"雾霾事件"},
		        	{color:"yellow",incident_name:"暴雨事件"},
		        	{color:"blue",incident_name:"台风事件"},
		        	{color:"green",incident_name:"龙卷风事件"},
		        ]
		    }]
		];//迁徙数据
		var startData=[
	    	{color:"red",incident_name:"雷暴事件"},
	    	{color:"orange",incident_name:"雾霾事件"},
	    	{color:"yellow",incident_name:"暴雨事件"},
	    	{color:"blue",incident_name:"台风事件"},
	    	{color:"green",incident_name:"龙卷风事件"},
	    ];//迁徙起点数据

		var convertData = function(data) {
		    var res = [];
		    for (var i = 0; i < data.length; i++) {
		        var dataItem = data[i];
		        var fromCoord = geoCoordMap[dataItem[0].name];
		        var toCoord = geoCoordMap[dataItem[1].name];
		        if (fromCoord && toCoord) {
		            res.push({
		                fromName: dataItem[0].name,
		                toName: dataItem[1].name,
		                coords: [fromCoord, toCoord]
		            });
		        }
		    }
		    return res;
		};
		var mapSeries = [];
		[
		    ['杭州', BJData],
		].forEach(function(item, i) {
		    mapSeries.push(
			    {//出发圆点
			        type: 'effectScatter',
			        coordinateSystem: 'bmap',
			        zlevel: 2,
			        symbolSize: 15,
			        itemStyle: {
			            normal: {
			                color: "red",
			                shadowColor: 'red',
							shadowBlur: 40,
							shadowOffsetX:5,
							shadowOffsetY:5
			            }
			        },
			        data: [{
			            name: item[0],
			            value: geoCoordMap[item[0]].concat([50]),
				        incident_data:startData

			        }]
			    },{//线、飞机
			        type: 'lines',
			        coordinateSystem: 'bmap',
			        zlevel: 2,
		    		// symbol:"rect",
			        effect: {
			            show: true,
			            period: 6,
			            trailLength: 0,
			            symbol: planePath,
			            symbolSize: 15
			        },
			        lineStyle: {
			            normal: {
			                color: "red",
			                width: 2,
			                curveness: 0.2,
	                		type: 'dotted'
			            }
			        },
			        data: convertData(item[1])
			    }, {//省份圆点红色事件
			    	name:"红色事件",
			        type: 'effectScatter',
			        coordinateSystem: 'bmap',
			        zlevel: 2,
			        symbolSize: 20,
		    		// symbol:"rect",//正方形
			        rippleEffect: {
			            brushType: 'stroke'
			        },
			        itemStyle: {
			            normal: {
			                color: function(params) {//省份圆点颜色设置
			     //    			console.log(params)
								// var tmp = params.data.incident;
								// if (tmp == 'orange') {
								// 	return '#ff9700';//橙色事件
								// } else if (tmp == 'green') {
								// 	return '#00e1b4';//绿色事件
								// } else if (tmp == 'blue') {
								// 	return '#518fff';//蓝色事件
								// } else if (tmp == 'red') {
									return '#ff3833';//红色事件
								// } else {
								// 	return '#fada00';//黄色事件
								// }
							},
			                shadowColor: '#ff3833',
							shadowBlur: 25,
							shadowOffsetX:5,
							shadowOffsetY:5,
			            }
			        },
			        data: item[1].map(function(dataItem) {
			        	if(dataItem[1].incident=="red"){
				            return {
				                value: geoCoordMap[dataItem[1].name].concat([dataItem[1].value]),
				                incident:dataItem[1].incident,
				                incident_data:dataItem[1].incident_data
				            };
				        }
			        })
			    }, {//省份圆点橙色事件
			    	name:"橙色事件",
			        type: 'effectScatter',
			        coordinateSystem: 'bmap',
			        zlevel: 2,
			        symbolSize: 20,
		    		// symbol:"rect",//正方形
			        rippleEffect: {
			            brushType: 'stroke'
			        },
			        itemStyle: {
			            normal: {
			                color: function(params) {//省份圆点颜色设置
			     //    			console.log(params)
								// var tmp = params.data.incident;
								// if (tmp == 'orange') {
									return '#ff9700';//橙色事件
								// } else if (tmp == 'green') {
								// 	return '#00e1b4';//绿色事件
								// } else if (tmp == 'blue') {
								// 	return '#518fff';//蓝色事件
								// } else if (tmp == 'red') {
									// return '#ff3833';//红色事件
								// } else {
								// 	return '#fada00';//黄色事件
								// }
							},
			                shadowColor: '#ff9700',
							shadowBlur: 40,
							shadowOffsetX:5,
							shadowOffsetY:5,
			            }
			        },
			        data: item[1].map(function(dataItem) {
			        	if(dataItem[1].incident=="orange"){
				            return {
				                value: geoCoordMap[dataItem[1].name].concat([dataItem[1].value]),
				                incident:dataItem[1].incident,
				                incident_data:dataItem[1].incident_data
				            };
				        }
			        })
			    }, {//省份圆点黄色事件
			    	name:"黄色事件",
			        type: 'effectScatter',
			        coordinateSystem: 'bmap',
			        zlevel: 2,
			        symbolSize: 20,
		    		// symbol:"rect",//正方形
			        rippleEffect: {
			            brushType: 'stroke'
			        },
			        itemStyle: {
			            normal: {
			                color: function(params) {//省份圆点颜色设置
			     //    			console.log(params)
								// var tmp = params.data.incident;
								// if (tmp == 'orange') {
									// return '#ff9700';//橙色事件
								// } else if (tmp == 'green') {
								// 	return '#00e1b4';//绿色事件
								// } else if (tmp == 'blue') {
								// 	return '#518fff';//蓝色事件
								// } else if (tmp == 'red') {
									// return '#ff3833';//红色事件
								// } else {
									return '#fada00';//黄色事件
								// }
							},
			                shadowColor: '#fada00',
							shadowBlur: 40,
							shadowOffsetX:5,
							shadowOffsetY:5,
			            }
			        },
			        data: item[1].map(function(dataItem) {
			        	if(dataItem[1].incident=="yellow"){
				            return {
				                value: geoCoordMap[dataItem[1].name].concat([dataItem[1].value]),
				                incident:dataItem[1].incident,
				                incident_data:dataItem[1].incident_data
				            };
				        }
			        })
			    }, {//省份圆点蓝色事件
			    	name:"蓝色事件",
			        type: 'effectScatter',
			        coordinateSystem: 'bmap',
			        zlevel: 2,
			        symbolSize: 20,
		    		// symbol:"rect",//正方形
			        rippleEffect: {
			            brushType: 'stroke'
			        },
			        itemStyle: {
			            normal: {
			                color: function(params) {//省份圆点颜色设置
			     //    			console.log(params)
								// var tmp = params.data.incident;
								// if (tmp == 'orange') {
									// return '#ff9700';//橙色事件
								// } else if (tmp == 'green') {
								// 	return '#00e1b4';//绿色事件
								// } else if (tmp == 'blue') {
									return '#518fff';//蓝色事件
								// } else if (tmp == 'red') {
									// return '#ff3833';//红色事件
								// } else {
									// return '#fada00';//黄色事件
								// }
							},
			                shadowColor: '#518fff',
							shadowBlur: 40,
							shadowOffsetX:5,
							shadowOffsetY:5,
			            }
			        },
			        data: item[1].map(function(dataItem) {
			        	if(dataItem[1].incident=="blue"){
				            return {
				                value: geoCoordMap[dataItem[1].name].concat([dataItem[1].value]),
				                incident:dataItem[1].incident,
				                incident_data:dataItem[1].incident_data
				            };
				        }
			        })
			    }, {//省份圆点绿色事件
			    	name:"绿色事件",
			        type: 'effectScatter',
			        coordinateSystem: 'bmap',
			        zlevel: 2,
			        symbolSize: 20,
		    		// symbol:"rect",//正方形
			        rippleEffect: {
			            brushType: 'stroke'
			        },
			        itemStyle: {
			            normal: {
			                color: function(params) {//省份圆点颜色设置
			     //    			console.log(params)
								// var tmp = params.data.incident;
								// if (tmp == 'orange') {
									// return '#ff9700';//橙色事件
								// } else if (tmp == 'green') {
									return '#00e1b4';//绿色事件
								// } else if (tmp == 'blue') {
									// return '#518fff';//蓝色事件
								// } else if (tmp == 'red') {
									// return '#ff3833';//红色事件
								// } else {
									// return '#fada00';//黄色事件
								// }
							},
			                shadowColor: '#00e1b4',
							shadowBlur: 40,
							shadowOffsetX:5,
							shadowOffsetY:5,
			            }
			        },
			        data: item[1].map(function(dataItem) {
			        	if(dataItem[1].incident=="green"){
				            return {
				                value: geoCoordMap[dataItem[1].name].concat([dataItem[1].value]),
				                incident:dataItem[1].incident,
				                incident_data:dataItem[1].incident_data
				            };
				        }
			        })
			    });
		});

		mapOption = {
		    bmap: {
			    center: [120.166085,30.279006],//地图中心
			    zoom: 8,
			    roam: true
			},
		    tooltip : {
		    	formatter: function (params, ticket, callback) {
				    var incident_data=params.data.incident_data;
				    var li="";
				    if(incident_data!=undefined){
					    for (var i = 0; i < incident_data.length; i++) {
					    	li=li+'<li><em>'+(i+1)+'</em><i class='+incident_data[i].color+'></i><span>'+incident_data[i].incident_name+'</span></li>'
					    }
					    var html='<div class="gb-incident-list scroll">'+
							    	'<ul>'+
							    		li+
							    	'</ul>'+
							    '</div>'
					    return html;
				    }else{
				    	var html='<div class="gb-incident-list scroll">'+
							    	'<ul>'+
							    		'<li><span>无</span></li>'
							    	'</ul>'+
							    '</div>'
					    return html;
				    }
				},
				enterable:true,
		    	position: function (point, params, dom, rect, size) {
				    // 固定在顶部
				    return {left: rect.x-($(dom).width()/2)+(rect.width/2.2), top: rect.y-$(dom).height()-10};
				},
		        backgroundColor: 'rgba(255,255,255,0)',
		    },
		    legend: {
		        orient: 'vertical',
		    	backgroundColor:'rgba(255,255,255,0.8)',
		        top: '30',
		        right: '30',
		        data: ['红色事件','橙色事件','黄色事件','蓝色事件','绿色事件'],
		        textStyle: {
		            color: '#7c8491',
		        	padding:[5,0]
		        },
		        align:"left",
		        padding:[10,25]
		    },
		    series: mapSeries
		};
		mapChart.setOption(mapOption);
	    // 获取百度地图对象
	    allbmap = mapChart.getModel().getComponent('bmap').getBMap();
		allbmap.centerAndZoom(new BMap.Point(120.166085,30.279006), 8);
	    blist = [];
	    districtLoading = 0;
		setTimeout(function () {
		// 地图划分区域地点
		    addDistrict("杭州",allbmap);
		    addDistrict("宁波",allbmap);
		    addDistrict("嘉兴",allbmap);
		    addDistrict("绍兴",allbmap);
		    addDistrict("台州",allbmap);
		    addDistrict("温州",allbmap);
		},100)
	}
	boolall=false;
}
addIncident()




$(".gb-main-item").on("click",".gb-unity-incident",function(){
	
	$(".gb-all-incident-item").hide()
	$(".gb-unity-incident-item").show()
	unityIncident();
})
$(".gb-main-item").on("click",".gb-all-incident",function(){
	$(".gb-all-incident-item").show()
	$(".gb-unity-incident-item").hide()
})
// 图表随屏幕大小自适应
$(".gb-packUp-leftNav").click(function(){
	setTimeout(function(){
		populationChart.resize();
		districtChart.resize();
		incidentChart.resize();
		incidentRankChart.resize();
		taskNumChart.resize();
		incidentTypeChart.resize();
	},400)
})
	
</script>